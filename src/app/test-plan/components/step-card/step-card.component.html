<div class="step-card" [attr.id]="'step-' + activeSheetIndex + '-' + index" [formGroup]="group">
  <div class="step-header-row">
    <input type="checkbox" [checked]="selected" (change)="toggleSelect.emit($event.target.checked)" title="Kijel√∂l√©s" class="row-checkbox" />

    <h3 class="step-title">{{ index + 1 }}. l√©p√©s</h3>

    <div class="mini-actions">
      <button type="button" class="mini-btn" (click)="copy.emit()"  title="M√°sol√°s"> üìã</button>
      <button type="button" class="mini-btn" (click)="paste.emit()" [disabled]="!clipboardHasContent" title="Beilleszt√©s">üì•</button>
    </div>

    <label class="switch">
      <input type="checkbox" formControlName="isSubtest">
      <span class="slider"></span>
      <span class="switch-label">Alteszt c√≠msor</span>
    </label>
  </div>

  <div class="form-group" *ngIf="isSubtest; else normalRow">
    <label>Alteszt neve</label>
    <input formControlName="subtestName" type="text" placeholder="Pl.: K√∂zgy√≥gyell√°t√°s szerkeszt√©s - alteszt blokk" />

    <div class="form-group" style="margin-top: 12px;">
      <label>Alteszt h√°tt√©rsz√≠ne</label>
      <input formControlName="subtestColor" type="color" style="width: 56px; height: 32px; padding: 0; border: none;" />
      <small class="hint" style="margin-left:8px;">Default: gray (#929292)</small>
    </div>
  </div>

  <ng-template #normalRow>
    <div class="form-group">
      <label>Funkci√≥</label>
      <input formControlName="function" type="text" />
    </div>

    <div class="form-group">
      <label>El≈ëfelt√©tel</label>
      <textarea formControlName="precondition" rows="6" placeholder="√çrd le az el≈ëfelt√©teleket"></textarea>
    </div>

    <div class="form-group">
      <label>Feladat/Tesztl√©p√©sek</label>
      <textarea formControlName="stepsText" rows="6" placeholder="√çrd le a l√©p√©seket, list√°zva"></textarea>
    </div>
    <div class="form-group">
      <label>Tesztadatok</label>
      <textarea formControlName="testData" rows="6" placeholder="√çrd le a tesztadatokat"></textarea>
    </div>
    <div class="form-group">
      <label>Elv√°rt eredm√©ny</label>
      <textarea formControlName="expected" rows="6" placeholder="√çrd le az elv√°rt kimenetet"></textarea>
    </div>
    <div class="form-group">
      <label>Megjegyz√©s</label>
      <textarea formControlName="comment" rows="6" placeholder="√çrd le a megjegyz√©seket"></textarea>
    </div>
  </ng-template>

  <div class="actions">
    <button type="button" class="add-step" (click)="addAfter.emit()">√öj l√©p√©s hozz√°ad√°sa</button>
    <button type="button" class="remove-step" (click)="remove.emit()">Sor t√∂rl√©se</button>
  </div>
</div>